<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>IPTV Web Player</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
body{background:#0a0a0a;color:#fff;font-family:Arial,Helvetica,sans-serif;display:flex;height:100vh;margin:0}
#left{width:320px;display:flex;flex-direction:column;border-right:1px solid #222}
#search{padding:10px;background:#111;border:none;color:white;font-size:15px;outline:none}
#list{flex:1;overflow-y:auto}
#player{flex:1;display:flex;align-items:center;justify-content:center}
.channel{padding:10px;border-bottom:1px solid #222;cursor:pointer;transition:0.2s}
.channel:hover{background:#1e1e1e}
.active{background:#004d17 !important;border-left:5px solid #22ff55}
</style>
</head>
<body>

<div id="left">
    <input type="text" id="search" placeholder="Buscar canal...">
    <div id="list"></div>
</div>

<div id="player">
    <video id="video" controls width="100%" height="100%"></video>
</div>

<script>
const M3U_URL = "https://iptv-org.github.io/iptv/index.m3u";
let channelsDOM = [];

async function loadList(){
    let text = await fetch(M3U_URL).then(r=>r.text());
    let lines = text.split("\n");
    let list = document.getElementById("list");

    for(let i=0;i<lines.length;i++){
        if(lines[i].startsWith("#EXTINF")){
            let name = lines[i].split(",")[1];
            let url = lines[i+1];

            let div = document.createElement("div");
            div.className="channel";
            div.innerText=name;
            div.dataset.url=url;
            div.onclick=()=>play(div);

            list.appendChild(div);
            channelsDOM.push(div);
        }
    }
}

function play(div){
    channelsDOM.forEach(c=>c.classList.remove("active"));
    div.classList.add("active");

    var url = div.dataset.url;
    var video = document.getElementById('video');

    if (Hls.isSupported()) {
        var hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = url;
    } else {
        alert("Video no compatible");
    }
}

document.getElementById("search").addEventListener("input", (e)=>{
    let text = e.target.value.toLowerCase();
    channelsDOM.forEach(c=>{
        if(c.innerText.toLowerCase().includes(text)){
            c.style.display="block";
        }else{
            c.style.display="none";
        }
    });
});

loadList();
</script>

</body>
</html>

